<!doctype html>
<html class="no-js" lang="{{ request.locale.iso_code }}">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="theme-color" content="#000000">
  
  <title>
    {{ page_title }}
    {%- unless page_title contains shop.name %} &ndash; {{ shop.name }}{% endunless -%}
  </title>

  {% if page_description %}
    <meta name="description" content="{{ page_description | escape }}">
  {% endif %}

  <link rel="canonical" href="{{ canonical_url }}">

  {{ content_for_header }}

  
  {{ 'theme.css' | asset_url | stylesheet_tag }}
  {{ 'component-quantity.css' | asset_url | stylesheet_tag }}
  <script src="{{ 'global.js' | asset_url }}" defer></script>
  <script src="{{ 'theme.js' | asset_url }}" defer></script>
  
  <!-- DOM Analysis Script -->
  <script>
    window.addEventListener('load', function() {
      setTimeout(() => {
        console.log('=== DOM ANALYSIS FOR {{ request.page_type | upcase }} PAGE ===');
        
        // Find main content container
        const mainContent = document.getElementById('MainContent');
        if (mainContent) {
          console.log('ðŸ“„ MAIN CONTENT STRUCTURE:');
          logDOMStructure(mainContent, 0, 4); // Max 4 levels deep
        }
        
        // Find title element
        const title = document.querySelector('h1');
        if (title) {
          console.log('ðŸ”¤ TITLE ELEMENT:');
          console.log('  Text:', title.textContent);
          console.log('  Classes:', title.className);
          console.log('  Parent classes:', title.parentElement?.className);
          console.log('  Computed styles:', {
            fontSize: getComputedStyle(title).fontSize,
            color: getComputedStyle(title).color,
            textAlign: getComputedStyle(title).textAlign,
            marginTop: getComputedStyle(title).marginTop,
            marginBottom: getComputedStyle(title).marginBottom,
            paddingTop: getComputedStyle(title).paddingTop,
            fontFamily: getComputedStyle(title).fontFamily
          });
        }
      }, 1000);
    });
    
    function logDOMStructure(element, level, maxLevel) {
      if (level > maxLevel) return;
      
      const indent = '  '.repeat(level);
      const tag = element.tagName?.toLowerCase() || 'text';
      const classes = element.className ? ` class="${element.className}"` : '';
      const id = element.id ? ` id="${element.id}"` : '';
      
      console.log(`${indent}${tag}${id}${classes}`);
      
      // Only log direct children, not all text nodes
      Array.from(element.children || []).forEach(child => {
        logDOMStructure(child, level + 1, maxLevel);
      });
    }
  </script>
</head>
<body class="template-{{ request.page_type | handle }}">
  

  <div class="mobile-cart-icon">
    {% if request.page_type == 'cart' %}
      <!-- Back button on cart page -->
      <a href="javascript:history.back()" aria-label="Torna indietro" class="back-button">
        <svg class="cart-icon" viewBox="0 0 24 24">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </a>
    {% else %}
      <!-- Cart icon on other pages -->
      <a href="/cart" aria-label="Carrello">
        <svg class="cart-icon" viewBox="0 0 24 24">
          <path d="M7 18c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
        </svg>
        {% if cart.item_count > 0 %}
          <span class="cart-count">{{ cart.item_count }}</span>
        {% endif %}
      </a>
    {% endif %}
  </div>

  <main id="MainContent" role="main">
    
    {% if request.page_type == 'product' %}
      <!-- Product Page with Sidebar -->
      <div class="navigation-container top" data-tabs-section>
          <!-- Mobile Burger Menu -->
          <div class="mobile-header">
            <button class="burger-menu" onclick="toggleMobileFooter()" aria-label="Apri menu">
              <span></span>
              <span></span>
              <span></span>
            </button>
          </div>
          
          <!-- Mobile Menu (hidden on desktop) -->
          <div class="mobile-menu" style="display: none;">
            <div class="menu-tabs">
              <button class="tab" onclick="window.location.href='/'">Home</button>
              <button class="tab active">Biglietti</button>
            </div>
          </div>

          <!-- Include sidebar navigation -->
          {% render 'sidebar-navigation' %}

        <!-- Content Area -->
        <div class="content-wrapper">
          <div class="content show">
            <div class="formatted-content" id="single-content">
              {{ content_for_layout }}
            </div>
          </div>
        </div>
      </div>

      <!-- Mobile Original Product (only <1024px) -->
      <div class="mobile-product-original">
        <!-- Content moved here via JS on mobile, not duplicated -->
        <div id="mobile-content-target"></div>
      </div>
      
      <script>
        // Move content to appropriate container based on screen size
        function moveContent() {
          const content = document.getElementById('single-content');
          const mobileTarget = document.getElementById('mobile-content-target');
          
          if (window.innerWidth < 1024) {
            // Mobile: move content to mobile container
            if (content && mobileTarget && !mobileTarget.hasChildNodes()) {
              mobileTarget.appendChild(content);
            }
          } else {
            // Desktop: content stays in original position
            const desktopParent = document.querySelector('.content.show');
            if (content && desktopParent && content.parentElement !== desktopParent) {
              desktopParent.appendChild(content);
            }
          }
        }
        
        // Run on load and resize
        window.addEventListener('load', moveContent);
        window.addEventListener('resize', moveContent);
        moveContent(); // Run immediately
      </script>

      <style>
      /* Mobile: nascondi navigation-container, mostra versione mobile */
      @media (max-width: 1023px) {
        {% if request.page_type == 'product' %}
          .navigation-container {
            display: none !important;
          }
          .mobile-product-original {
            display: block;
          }
        {% endif %}
      }
      
      /* Desktop: mostra navigation-container, nascondi mobile */
      @media (min-width: 1024px) {
        .mobile-product-original {
          display: none;
        }
      }
      </style>
    
    {% else %}
      <!-- All other pages: normal layout -->
      {{ content_for_layout }}
    {% endif %}
    
  </main>
  
  <!-- Mobile Footer Snap Menu -->
  {% render 'footer-snap' %}
  
  {% render 'evey-confirm-load' %}
</body>
</html>