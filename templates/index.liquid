<!-- LUCINE MINIMAL -->
<script>
console.log('üéØ INDEX.LIQUID TEMPLATE LOADED');
console.log('üìã MENU ITEMS:');
{% assign main_menu = linklists['menu-principale'] %}
{% for link in main_menu.links %}
console.log('{{ forloop.index }}. {{ link.title }} - URL: {{ link.url }}');
{% endfor %}
</script>

<!-- Video Background -->
<div class="video-bg">
  <video autoplay muted loop playsinline>
    <source src="https://cdn.shopify.com/videos/c/o/v/088cf9e084664519ad8bf3af537b87fe.mp4" type="video/mp4">
  </video>
</div>

<!-- Navigation Container -->
<div class="navigation-container" data-tabs-section>
  <!-- Menu -->
  <div class="mobile-menu">
    <div class="menu-tabs">
      <!-- Home sempre primo -->
      <button class="tab" data-index="0">Home</button>
      
      <!-- Menu dinamico da Shopify -->
      {% assign main_menu = linklists['menu-principale'] %}
      {% for link in main_menu.links %}
        <button class="tab" data-index="{{ forloop.index }}" data-url="{{ link.url }}">
          {{ link.title }}
        </button>
      {% endfor %}
    </div>
  </div>

  <!-- Content Area -->
  <div class="content">
    <!-- Home content -->
    <div class="tab-content active" data-index="0">
      <div class="content-section">
        <div class="formatted-content">
          <h1>Lucine di Natale</h1>
          <p class="christmas-accent">Un viaggio magico nel cuore del Natale per <span class="highlight-text">tutta la famiglia</span></p>
          
          <div class="event-card">
            <h3 class="christmas-accent">Benvenuti nel nostro mondo incantato</h3>
            <p>Dal <span class="highlight-text">1 al 24 dicembre</span>, il centro storico si trasforma in un villaggio natalizio dove magia e tradizione si incontrano.</p>
            <p>Spettacoli di luci, laboratori creativi, mercatini artigianali e tanto altro vi aspettano per creare insieme ricordi indimenticabili.</p>
            <a href="#" class="family-cta" onclick="document.querySelector('.tab[data-index=\"2\"]').click(); return false;">Scopri il Programma</a>
          </div>
          
          <div class="info-grid">
            <div class="info-box">
              <h4>üìÖ Quando</h4>
              <p>1-24 Dicembre<br>15:00 - 21:00</p>
            </div>
            <div class="info-box">
              <h4>üìç Dove</h4>
              <p>Centro Storico<br>Piazza Principale</p>
            </div>
            <div class="info-box">
              <h4>üéüÔ∏è Biglietti</h4>
              <p>Da ‚Ç¨10<br>Famiglia ‚Ç¨40</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Homepage content -->
    <div class="tab-content" data-index="0">
      <div class="content-section">
        <div class="formatted-content">
          <h1>Lucine di Natale</h1>
          <p>Benvenuti nel magico mondo delle <span style="color: var(--christmas-red);">Lucine di Natale</span>!</p>
          <p>Un'esperienza incantevole per tutta la famiglia con installazioni luminose uniche e atmosfere natalizie indimenticabili.</p>
        </div>
      </div>
      
    </div>

    <!-- Dynamic content con design system -->
    {% for link in main_menu.links %}
      <div class="tab-content" data-index="{{ forloop.index }}">
        <div class="content-section">
          {% comment %} Contenuto con styling natalizio {% endcomment %}
          {% if link.url contains '/pages/' %}
            {% assign page_handle = link.url | split: '/pages/' | last %}
            {% assign page = pages[page_handle] %}
            
            <!-- DEBUG: Page handle: {{ page_handle }} -->
            <!-- DEBUG: Page exists: {% if page %}YES{% else %}NO{% endif %} -->
            <!-- DEBUG: Content blank: {% if page.content == blank %}YES{% else %}NO{% endif %} -->
            
            {% if page.content != blank %}
              <div class="page-content formatted-content">
                {{ page.content }}
              </div>
            {% endif %}
            
          {% elsif link.url contains '/products/' %}
            <!-- Product tab content - will be loaded via AJAX -->
            <div class="product-tab-placeholder formatted-content">
              <div class="loading" style="text-align: center; padding: 3rem; color: var(--christmas-green);">
                üéÑ Caricamento prodotto...
              </div>
            </div>
            
          {% else %}
            <!-- Other link types -->
            <div class="formatted-content">
              <h2>{{ link.title }}</h2>
              <p>Contenuto in caricamento...</p>
              <a href="{{ link.url }}" class="cta">Visualizza pagina completa ‚Üí</a>
            </div>
          {% endif %}
        </div>
      </div>
    {% endfor %}
  </div>
</div>

<!-- GLOBAL FOOTER - Outside tabs, triggered by scroll -->
{% render 'footer-snap' %}

<!-- ERUDA MOBILE DEBUGGER (TEMPORARY) -->
<script src="https://cdn.jsdelivr.net/npm/eruda"></script>
<script>
  eruda.init();
  
  // Log collector for easy copy/paste
  window.debugLogs = [];
  const originalLog = console.log;
  console.log = function(...args) {
    // Store logs with timestamp
    const timestamp = new Date().toLocaleTimeString();
    window.debugLogs.push(`[${timestamp}] ${args.join(' ')}`);
    // Keep max 100 logs to avoid memory issues
    if (window.debugLogs.length > 100) {
      window.debugLogs.shift();
    }
    originalLog.apply(console, args);
  };
  
  // Function to copy all logs
  window.copyLogs = function() {
    const allLogs = window.debugLogs.join('\n');
    navigator.clipboard.writeText(allLogs).then(() => {
      alert('Logs copiati negli appunti!');
    }).catch(() => {
      // Fallback: show logs in alert for manual copy
      prompt('Copia questi logs:', allLogs);
    });
  };
</script>

<!-- BACK TO TOP BUTTON -->
<button id="back-to-top" onclick="scrollToTop()">‚Üë</button>

