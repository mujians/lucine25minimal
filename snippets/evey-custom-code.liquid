<script>
   function blockMultiTicket(){
    const fetchEventId = document.querySelector('input[name="properties[_event_id]"]');
    const eveyVariantContainers = document.querySelectorAll('.evey__variant-container');
    const eveyVariants = document.querySelector('.evey__variants');
    const fetchEventIdobserver = new MutationObserver((mutations) => {
      mutations.forEach((mutation) => {
          
        if (document.querySelector('input[name="properties[_event_id]"]').value == '') {
            // console.log(document.querySelector('input[name="properties[_event_id]"]').value)
            eveyVariantContainers.forEach(container => {
              container.style.pointerEvents = 'none';
            });
            eveyVariants.style.cursor = 'not-allowed';
            }else{
                eveyVariantContainers.forEach(container => {
                  container.style.pointerEvents = 'all';
                });
                eveyVariants.style.cursor = 'auto';
            }
      });
    });
    
    const fetchEventIdconfig = {
      attributes: true,
      childList: true,
      characterData: true,
      subtree: true
    };
    
    fetchEventIdobserver.observe(fetchEventId, fetchEventIdconfig);

  }

  
  const fetchEveyMetaData = {{ product.metafields.evey.event.value | default: product.metafields.evey.event | json }};
  console.log("Evey MetaData:", fetchEveyMetaData);
  console.log("Product Type:", "{{ product.type }}");
  console.log("Product ID:", {{ product.id }});
  
  if (fetchEveyMetaData && fetchEveyMetaData.date_type === "recurring") {
    console.log("Product is event with recurring dates");
    let productBlocks = document.querySelector("#MainContent");
    let pbObserver = new MutationObserver(function () {
        // const checkForEveyScheduler = document.querySelector('#evey-schedule-calendar-modal');
        const fetchEventId = document.querySelector('input[name="properties[_event_id]"]')
        const eveyVariantContainers = document.querySelectorAll('.evey__variant-container');
        const eveyVariants = document.querySelector('.evey__variants');
        if (eveyVariantContainers && eveyVariants && fetchEventId) {
            pbObserver.disconnect();
            eveyVariantContainers.forEach(container => {
              container.style.pointerEvents = 'none';
            });
            eveyVariants.style.cursor = 'not-allowed';
            console.log("Evey Scheduler Loaded 123");
            blockMultiTicket();
        }
    });

    pbObserver.observe(productBlocks, { attributes: false, childList: true, subtree: true });
  }
</script>